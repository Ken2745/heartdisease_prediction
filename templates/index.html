<!DOCTYPE html>
<html>
  <head>
    <title>Heart Disease Prediction</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
    />
    <style>
      .form-group {
        margin-bottom: 15px;
      }
    </style>
  </head>

  <body>
    <div class="container mt-4">
      <div class="row justify-content-center">
        <div class="col-md-8">
          <div class="card">
            <div
              class="card-header bg-primary text-white"
              style="display: flex; justify-content: center;"
            >
              <h2>Heart Disease Prediction Form</h2>
            </div>

            <div class="card-body">
              <form id="prediction-form">
                <div class="form-group">
                  <label for="age">Age</label>
                  <input type="number" class="form-control" id="age" required />
                </div>

                <div class="form-group">
                  <label for="sex">Sex</label>
                  <select class="form-control" id="sex">
                    <option value="0">Female</option>
                    <option value="1">Male</option>
                  </select>
                </div>

                <div class="form-group">
                  <label for="cp">Chest Pain Type (0–3)</label>
                  <input type="number" class="form-control" id="cp" min="0" max="3" required />
                </div>

                <div class="form-group">
                  <label for="trestbps">Resting Blood Pressure</label>
                  <input type="number" class="form-control" id="trestbps" required />
                </div>

                <div class="form-group">
                  <label for="chol">Cholesterol (mg/dl)</label>
                  <input type="number" class="form-control" id="chol" required />
                </div>

                <div class="form-group">
                  <label for="fbs">Fasting Blood Sugar &gt; 120 mg/dl</label>
                  <select class="form-control" id="fbs">
                    <option value="0">False</option>
                    <option value="1">True</option>
                  </select>
                </div>

                <div class="form-group">
                  <label for="restecg">Resting ECG</label>
                  <select class="form-control" id="restecg">
                    <option value="0">0</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                  </select>
                </div>

                <div class="form-group">
                  <label for="thalach">Max Heart Rate</label>
                  <input type="number" class="form-control" id="thalach" required />
                </div>

                <div class="form-group">
                  <label for="exang">Exercise Induced Angina</label>
                  <select class="form-control" id="exang">
                    <option value="0">False</option>
                    <option value="1">True</option>
                  </select>
                </div>

                <div class="form-group">
                  <label for="oldpeak">ST Depression</label>
                  <input type="number" step="0.01" class="form-control" id="oldpeak" required />
                </div>

                <div class="form-group">
                  <label for="slope">Slope</label>
                  <select class="form-control" id="slope">
                    <option value="0">0</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                  </select>
                </div>

                <div class="form-group">
                  <label for="ca">Number of Vessels</label>
                  <input type="number" class="form-control" id="ca" min="0" max="3" required />
                </div>

                <div class="form-group">
                  <label for="thal">Thal</label>
                  <select class="form-control" id="thal">
                    <option value="0">0</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">4</option>
                  </select>
                </div>

                <button type="submit" class="btn btn-primary mt-3">
                  Predict
                </button>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- JSON API SCRIPT -->
    <script>
      document.getElementById("prediction-form").addEventListener("submit", async function (e) {
        e.preventDefault();

        const data = {
          age: Number(age.value),
          sex: Number(sex.value),
          cp: Number(cp.value),
          trtbps: Number(trestbps.value),
          chol: Number(chol.value),
          fbs: Number(fbs.value),
          restecg: Number(restecg.value),
          thalachh: Number(thalach.value),
          exng: Number(exang.value),
          oldpeak: Number(oldpeak.value),
          slp: Number(slope.value),
          caa: Number(ca.value),
          thall: Number(thal.value)
        };

        try {
          const res = await fetch("/predict", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data)
          });

          const result = await res.json();

          alert(
            result.prediction === 1
              ? "⚠️ High risk of heart disease detected"
              : "✅ Low risk of heart disease detected"
          );
        } catch (err) {
          alert("❌ Error making prediction");
          console.error(err);
        }
      });
    </script>
  </body>
</html>
